# ids
ids-sys-marker

В отчете написать «вместо такой сети выбрана такая то»



1 модуль

IDS

Адаптеры 1 eth0 и 2 eth0

В пути машины в папке IDS…vmx (три квадрата) открываем с помощью wordpad и пишем строчку ethereum1.noPromisc = “FALSE” и сохраняем- запускаем машину

idsuser vipnet vipnet, меняем пароль на xxXX1234xxXX1234

Сетевые настройки - eth0 -Интерфейс Управляющий, 192.168.33.100/24, шлюз и DNS 192.168.33.5

Расшир.настройки -addr add 192.168.33.100/24 dev eth0 -Применить

Сертификаты -Трансп.сертификат -192.168.33.225 -Обновить

Учетные записи - user2 xxXX1234xxXX1234 - Администратор - применить - сделать скриншот





———-

TIAS

admin

xxXX1234xxXX1234!

Network -ens33 -Edit -Status UP, Network STATIC, 192.168.33.225/24, 192.168.33.5 -Apply



————

DEMO.LAB-AD

IP-адрес -192.168.33.5/24

шлюз 192.168.33.2

 2 адаптера 0 и 8(NAT)

Заходим в IDS VIPNET, вводим admin vipnet

Вылезает окно смены пароля - xxXX1234 xxXX1234

Состояние сенсора будет красным -установить лицензию (от препода-Vipnet-vipnet поставка-ids- lic.itcslic)-активировать через интернет 

В папке IDS открываем lic.creds- переходим на сайт в файле - вводим данные из файла- выгрузить БАЗУ ПРАВИЛ подсвеченную rules…3.7.tgz и БАЗУ MALWARE

В консоли ViPNET IDS Обновить 



2 модуль

В  Active Directory создать подразделение Office и в нем 2 пользователей: ftp_backup… и smbuser


FTP 
Диспетчер серверов -управление -добавить роли… - по умолчанию - Веб-сервер (IIS) добавить компоненты - SMB 1.0/CIFS … server - FTP-сервер служба FTP - Установить



Создать в диске С FTP папку, в ней еще пару папок и текст.документов



Средства - Диспетчер служб IIS - по DEMOLAB -добавить ftp-сайт - my_ftp, c:\ftp - 192.168.33.5, без SSL -Обычная, указанные пользователи ftpuser, чтение и запись 

Раскрыть DEMOLAB -my_ftp- Изоляция пользователей -Каталог имени пользователей и применить

По my_ftp -добавить вир.каталог -ftp

Вир.каталог ftp -редакт.разрешение - Безопасность - Дополнительно -Отключение наследования -Преобразовать … -Применить и ОК

Изменить -Users удаляем- Добавить -Дополнительно -Поиск и выбираем ftpuser -OK -выбираем ему все галочки -ОК

В Windows машине Проводник -ftp://192.168.33.5

ftpuser xxXX1234



SAMBA
Файловые службы -Общие ресурсы -ЗАДАЧИ Новый Общий ресурс - Далее -Далее - имя Shr -Вкл перечисления… -Далее -Создать

   В машине WSRV-WIN 

1 способ. Панель управления -Программы -удаление программ -вкл и выкл -Поддержка общего доступа к файлам SMB 1.0/CIFS -Клиент 

2 способ. PowerShell от имени админа - enable-windowsOptionalFeature -online -Featurename smb1protocol

PowerShell от имени админа- 

get-smbserverconfiguration | select enablesmb1protocol, enablesmb2protocol



Проводник -\\192.168.33.5

 Administrator xxXX1234



Диск С -папка Shares -Shr Свойства -Безопасность -Дополнительно -Отключение наследования -Преобразовать … -Применить и ОК

Изменить -Users удаляем- Добавить -Дополнительно -Поиск и выбираем smbuser -OK -выбираем ему все галочки -ОК



Google: 
192.168.33.100 IDS 

admin xxXX1234xxXX1234

192.168.33.225 TIAS

Administrator Administrator 



      IDS: Сетевые настройки -Сертификаты -Выгрузить корневой сертификат -Сохранить -Открыть -Установить… -Локальный -Поместить все… Обзор Доверен.корн.центры -Далее и Готово

     TIAS: Сервисные функции -Управление сертификатами -Корн.сам.сертификат -Перевыпустить Russia httbpt Выпустить

Собст.трансп.сертификат -адрес 192.168.33.225 Выпустить - Установить 

     Настройки Google - Конфид… и безопасность - Безопасность - Управление сертификатами устройства - Доверенные корн.центры -Импорт -Далее -Обзор и выбрать нужный сертификат 



       IDS: TCP, ANY, any, ->,$HOME_NET, any, DOS HTTP, attepmted-dos, 4, 4000000

В KALI написать командой атаку 

nmap -sV —script “*http-*” 192.168.33.5

 Добавить параметр -CONTENT-????????-Сохранить

      TCP, ANY, any, ->,$HOME_NET, any, 502, Modbus, Добавить параметр -bad-unknown, 4, 8448, добавить 2 CONTENT 4 и 8448

       TCP, ANY, any, ->, $HOME_NET, any, SQL http, Добавить web-application, 4, 4000001, Добавить параметр CONTENT select AND CONTENT User-Agent|3A|

        

SQL можно найти в атаках



Visual Syslog                          
Установить все по умолчанию 

Открыть -Setup -UDP 192.168.33.5 514, TCP 192.168.33.5 514 -OK

Setup -Files -Rotation by date Day 1 hour - Name+number- OK



IDS: Интеграция -Syslog -Передавать инф… - 192.168.33.5 514 Добавить -Отправить текст.сообщение (Успешно) -Убрать галочку на Использовать формат… скриншот

Интеграция с TIAS - Добавить - 192.168.33.225 34222 и механизм гарант.доставки; еще раз добавляем 192.168.33.225 5001 и не ставим механизм гарант.доставки 

Сетевое окружение -any- 192.168.33.0/24



В событиях не на своих атаках найти названия и в Гугле искать с CVE



TIAS: Инфраструктура - test - Новый сенсор - IDS NS - sensor- идентификатор берем в VipNET IDS в интеграции с TIAS внешний идентификатор сенсора 5507…- 192.168.33.100 - admin xxXX1234xxXX1234- 192.168.33.0/24- не указываем ничем в последних 2 строках-чувствительность 50- добавить- скриншот 

Учетные записи - новая учетная запись - officerLocal06 - пароль сгенерировать- роли Главный Администратор и на шестеренку - включить Область действия не ограничена и применить - создать - скриншот 



TIAS: Интеграция -Новый сервер - 192.168.33.5 514 TCP -Объекты инфраструктуры DemoLab -Статус и Уровень всё и Вкл передачу … -Сохранить 

Учетные записи - Новая…- officert6, пароль в задании можно свой (в отчете пароль не подходит по параметрам)- Администратор-шестеренка и Область неограниченна… Сфотать уведомление об несоответствии логина 



3 модуль

ГРУППОВЫЕ ПОЛИТИКИ

Синхронизация -Конф.Windows -Администр.шаблоны -Система -Взод в систему - Вход по сети и тд ВКЛ



Политика 1 - изменить - Конф комп - Политики -Конф.Windows - Параметры безопастности- Политика уч.з-Политика паролей: Макс.срок действия, Мин.длина пароля - ПОЛИТИКА БЛОК.У.З: Пороговое значение блокировки, Продолж. блокировки

После перейти в Управление и добавить комп - Добавить -Дополнительно- Тип объектов Компьютеры- Поиск -ADMIN01 -OK -Прошедшие проверку Удалить 



Политика 2 - Конф.комп - Администр.шаблоны- Система -Запретить запуск из справки переч.программ - Включено, ipconfig.exe, dialer.exe-Применить и ОК

После перейти в Управление и добавить комп - Добавить -Дополнительно- Тип объектов Компьютеры- Поиск -ADMIN01 -OK -Прошедшие проверку Удалить

В cmd вести команду start C:\Windows\System32\ipconfig.exe



Политика 3 Кофн.пользователи- Политики - Админстр.шаблоны -Система -Запретить командную строку и Запретить реестр Включено- Применить и ОК

После перейти в Управление и добавить пользователя - Добавить -Дополнительно- Тип объектов Пользователи - Поиск -admin01 -OK -Прошедшие проверку Удалить 



Политика 4 - Конф.пользователя - Политики -Администр.шаблоны -Меню «Пуск»- Удалить и запретить доступ к командам «Завершение» Включено- Применить и ОК

После перейти в Управление и добавить пользователя - Добавить -Дополнительно- Тип объектов Пользователи - Поиск -admin01 -OK -Прошедшие проверку Удалить 



Политика 5 - создать с надписью в ней картинку - скопировать ее путь - Конф.пользователя -Политики- Админист.шаблоны -Рабочий стол- Рабочий стол -Включить Active Desktop -Фоновые рисунки рабочего стола Включено и вставить путь и ее название с расширением  картинки -ОК



————

Win10

eth0

192.168.33.135/24, шлюз 192.168.33.5, DNS сервер 192.168.33.5



3 модуль

В машине demo.lab создать пользователя admin01 и загнать его в домен (admin01 demo.lab, admin01 xxXX1234)

или если не входит при пуске: demo.lab\admin01 xxXX1234

В cmd написать команду gpupdate

———-

KALI

Настроить вручную -IP- адрес 192.168.33.140/24, 192.168.33.5

kali xxXX1234



2 модуль 

ifconfig
nmap -sV —script=ftp-brute 192.168.33.5

enum4linux -S -u smbuser -p xxXX1234 192.168.33.5

nmap -sV —script=http-sitemap-generator 192.168.33.5 (PHP),(В событиях найти класс web…)

nmap -sV —script=firewall-bypass 192.168.33.5

nmap -sV —script -ftp-proftpd-backdoor 192.168.33.5 (PROFTPD)
